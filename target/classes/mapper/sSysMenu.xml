<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cms.modules.mapper.dao.SSysMenuDao">

    <resultMap id="BaseResultMap" type="com.cms.modules.mapper.model.po.SSysMenuPO">
		<id column="id" property="id" jdbcType="BIGINT"/>
		<result column="name" property="name" jdbcType="VARCHAR"/>
		<result column="pid" property="pid" jdbcType="INTEGER"/>
		<result column="url" property="url" jdbcType="VARCHAR"/>
		<result column="type" property="type" jdbcType="INTEGER"/>
		<result column="state" property="state" jdbcType="INTEGER"/>
		<result column="description" property="description" jdbcType="VARCHAR"/>
		<result column="sort" property="sort" jdbcType="INTEGER"/>
		<result column="createtime" property="createtime" jdbcType="TIMESTAMP"/>
    </resultMap>

    <insert id="insert">
        INSERT INTO s_sys_menu(id,name,pid,url,type,state,description,sort,createtime)
        VALUES(null,#{name},#{pid},#{url},#{type},#{state},#{description},#{sort},#{createtime})
    </insert>
    <insert id="batchInsert" parameterType="list">
        INSERT INTO s_sys_menu(id,name,pid,url,type,state,description,sort,createtime)
        VALUES
        <foreach collection="list" item="item" index="index" separator=",">
            (null,#{item.name},#{item.pid},#{item.url},#{item.type},#{item.state},#{item.description},#{item.sort},#{item.createtime})
        </foreach>
        ON DUPLICATE KEY UPDATE
        id=VALUES(id),name=VALUES(name),pid=VALUES(pid),url=VALUES(url),type=VALUES(type),state=VALUES(state),description=VALUES(description),sort=VALUES(sort),createtime=VALUES(createtime)
    </insert>
    <update id="update">
        UPDATE s_sys_menu
        <trim prefix="SET" suffixOverrides=",">
			<if test="name!=null">
                name=#{name},
            </if>
			<if test="pid!=null">
                pid=#{pid},
            </if>
			<if test="url!=null">
                url=#{url},
            </if>
			<if test="type!=null">
                type=#{type},
            </if>
			<if test="state!=null">
                state=#{state},
            </if>
			<if test="description!=null">
                description=#{description},
            </if>
			<if test="sort!=null">
                sort=#{sort},
            </if>
        </trim>
        WHERE id=#{id}
    </update>

    <sql id="SELECT_FIELD">
        id,name,pid,url,type,state,description,sort,createtime
    </sql>

    <sql id="QUERY_SQL">
        from s_sys_menu
        <where>
			<if test="id!=null and id!=-1">
               AND id=#{id}
            </if>
			<if test="name!=null">
               AND name=#{name}
            </if>
			<if test="pid!=null and pid!=-1">
               AND pid=#{pid}
            </if>
			<if test="url!=null">
               AND url=#{url}
            </if>
			<if test="type!=null and type!=-1">
               AND type=#{type}
            </if>
			<if test="state!=null and state!=-1">
               AND state=#{state}
            </if>
			<if test="description!=null">
               AND description=#{description}
            </if>
			<if test="sort!=null and sort!=-1">
               AND sort=#{sort}
            </if>
			<if test="createtime!=null">
               AND createtime=#{createtime}
            </if>

        </where>
    </sql>

    <select id="query" resultMap="BaseResultMap">
        select <include refid="SELECT_FIELD"/>
        <include refid="QUERY_SQL"/>
        <if test="limit!=null and limit!=-1 ">
            <if test="offset!=null and offset!=-1">
                limit #{offset},#{limit}
            </if>
        </if>
    </select>

    <select id="count" resultType="long">
        select count(*)
        <include refid="QUERY_SQL"/>
    </select>

</mapper>